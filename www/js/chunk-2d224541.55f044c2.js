(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d224541"],{e055:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"tw-body"},[s("div",{staticClass:"tw-body-inner xcontainer"},[s("div",{staticClass:"tw-crm"},[s("router-link",{staticClass:"tw-crm-link",attrs:{to:"/"}},[t._v("项目")]),s("i",{staticClass:"tw-crm-arrow"}),s("span",{staticClass:"tw-crm-self ml-step"},[t._v(t._s(t.project.project_name))])],1),s("div",{staticClass:"tw-card mb-medium pb-medium"},[s("div",{staticClass:"tw-title xnomark xico"},[s("div",{staticClass:"tw-title-left"},[s("i",{staticClass:"tw-ico xeco xsmall"}),s("span",{staticClass:"text-default"},[t._v(t._s(t.project.project_name))])]),t.$app.user.role===t.$cnt.ROLE_TEAM_LEADER?s("div",{staticClass:"tw-title-right"},[s("router-link",{staticClass:"tw-icobtn",attrs:{to:"/new-project?id="+t.$route.query.id}},[s("i",{staticClass:"tw-ico xedit"}),t._v("编辑")]),s("a",{staticClass:"tw-icobtn",on:{click:t.delProject}},[s("i",{staticClass:"tw-ico xdel"}),t._v("删除")])],1):t._e()]),s("div",{staticClass:"tw-grid xpc4 xlpad4 xpad4 text-center"},[s("div",{staticClass:"tw-grid-col"},[s("div",{staticClass:"text-large"},[t._v(t._s(t.leader.user_name||"--"))]),s("div",{staticClass:"text-small text-weaking scale-less-medium"},[t._v(t._s(t.leader.mobile||"--")+"(手机)")]),t._m(0)]),s("div",{staticClass:"tw-grid-col"},[s("div",{staticClass:"text-huge"},[s("span",{staticClass:"text-highlight"},[t._v(t._s(t.project.invested_time))]),t._v("/"+t._s(t.project.task_time))]),s("div",{staticClass:"text-small text-weaking scale-less-medium"},[t._v("已投入/总工时(人天)")]),t._m(1)]),t._m(2),t._m(3)])]),s("div",{directives:[{name:"bottom",rawName:"v-bottom",value:70,expression:"70"}],staticClass:"tw-card xradius px-medium pb-huge"},[s("div",{staticClass:"tw-title"},[s("h3",{staticClass:"tw-title-left text-default"},[t._v("项目详情")]),s("div",{staticClass:"tw-title-right"},[s("ul",{staticClass:"tw-steps xstripe"},t._l(t.project.timeNodes,(function(e,a){return s("li",{key:a,staticClass:"tw-steps-item",class:{xdone:"done"===e.status,xactive:"active"===e.status},style:"z-index:"+(t.project.timeNodes.length-a)+";"},[s("span",[t._v(t._s(e.text))])])})),0)])]),s("div",{staticClass:"text-small"},[s("a",{staticClass:"tw-tag xsmall dt-n1 p-0 mr-step",class:{xrisk:"risky"===t.project.status,xnormal:"risky"!==t.project.status}}),"risky"===t.project.status?s("span",{staticClass:"text-secondary"},[t._v("有风险, 进度延期"+t._s(parseInt(t.project.expectant_progress-t.project.progress))+"%")]):s("span",[t._v(t._s(t.$dic.select(t.$dic.projectStatus,t.project.status)))])]),s("div",{staticClass:"tw-flex align-items-center text-center"},[s("div",{staticStyle:{width:"30%"}},[s("el-progress",{attrs:{type:"circle",width:150,percentage:t.project.progress,"stroke-width":8,color:"risky"===t.project.status?"#666":"#f56c6c"}})],1),s("div",{staticClass:"tw-flex-body"},[s("tw-chart",{attrs:{height:"240px",categoryKey:"developer_name",option:{legend:{show:!1},tooltip:{formatter:"{b}<br />完成：{c}%"}},dataMaps:t.project.chartDataMaps}})],1)]),s("tw-collapse-group",[s("div",{staticClass:"text-center mt-medium"},[s("ul",{staticClass:"tw-btngroup"},[s("li",{staticClass:"js-project1-schedule"},[s("a",{staticClass:"tw-btn xweaking"},[t._v("进度详情")])]),s("li",{staticClass:"js-project1-info"},[s("a",{staticClass:"tw-btn xweaking"},[t._v("项目信息")])])])]),s("tw-collapse",{attrs:{"default-open":"",switch:".js-project1-schedule"}},[s("div",{staticClass:"tw-twrapper mt-medium"},[s("table",{staticClass:"tw-table xnowrap"},[s("thead",[s("tr",[s("th",{staticStyle:{width:"4em"}},[t._v("序号")]),s("th",{staticStyle:{width:"300px"}},[t._v("任务名称")]),s("th",[t._v("开发")]),s("th",{staticStyle:{width:"150px"}},[t._v("进度")]),s("th",[t._v("难度等级")]),s("th",{staticStyle:{width:"70px"}},[t._v("工时")]),s("th",{staticStyle:{width:"130px"}},[t._v("计划开始时间")]),s("th",{staticStyle:{width:"130px"}},[t._v("计划完成时间")])])]),s("tbody",[t._l(t.project.plans,(function(e,a){return["group"===e.task_type?s("tr",{key:e.id},[s("td",{staticClass:"text-bold",attrs:{colspan:"8"}},[t._v(t._s(e.task_name))])]):s("tr",{key:e.id},[s("td",[t._v(t._s(a-t.getOffsetIdx(a)))]),s("td",[t._v(t._s(e.task_name))]),s("td",[t._v(t._s(e.developer_name))]),s("td",[s("el-progress",{attrs:{percentage:100*e.progress,format:t.format,color:"risky"===e.status?"#f56c6c":"#218fff"}})],1),s("td",[t._v(t._s(t.$dic.select(t.$api.dic.degreens.data.list,e.degreen,"degreen_name")))]),s("td",[t._v(t._s(e.task_time))]),s("td",[t._v(t._s(t.$ui.dateFormat(e.start_time,"yyyy-mm-dd HH:MM")))]),s("td",[t._v(t._s(t.$ui.dateFormat(e.end_time,"yyyy-mm-dd HH:MM")))])])]}))],2)])])]),s("tw-collapse",{attrs:{switch:".js-project1-info"}},[s("div",{staticClass:"tw-twrapper mt-medium"},[s("table",{staticClass:"tw-table"},[s("thead",[s("tr",[s("th",{staticStyle:{width:"200px"}},[t._v("项目相关url")]),s("th",[t._v("url")])])]),s("tbody",[t.project.project_svn?s("tr",[s("td",[t._v("项目SVN目录")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_svn,target:"_blank"}},[t._v(t._s(t.project.project_svn))])])]):t._e(),t.project.project_prd_url?s("tr",[s("td",[t._v("需求文档地址")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_prd_url,target:"_blank"}},[t._v(t._s(t.project.project_prd_url))])])]):t._e(),t.project.project_design_svn?s("tr",[s("td",[t._v("高保真SVN")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_design_svn,target:"_blank"}},[t._v(t._s(t.project.project_design_svn))])])]):t._e(),t.project.project_psd_svn?s("tr",[s("td",[t._v("设计源文件SVN")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_psd_svn,target:"_blank"}},[t._v(t._s(t.project.project_psd_svn))])])]):t._e(),t.project.project_api_svn?s("tr",[s("td",[t._v("接口文档地址")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_api_svn,target:"_blank"}},[t._v(t._s(t.project.project_api_svn))])])]):t._e(),t.project.project_test_case_svn?s("tr",[s("td",[t._v("测试用例地址")]),s("td",[s("a",{staticClass:"text-link",attrs:{href:t.project.project_test_case_svn,target:"_blank"}},[t._v(t._s(t.project.project_test_case_svn))])])]):t._e(),t.project.remark?s("tr",[s("td",[t._v("备注")]),s("td",[s("pre",[t._v(t._s(t.project.remark))])])]):t._e()])])])])],1)],1)])])},r=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-medium"},[s("i",{staticClass:"tw-ico xdev dt-n1 mr-3"}),t._v("项目负责人")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"text-medium"},[s("i",{staticClass:"tw-ico xcmonth dt-n1 mr-3"}),t._v("项目工时")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tw-grid-col"},[s("div",{staticClass:"text-huge"},[s("span",{staticClass:"text-highlight"},[t._v("--")]),t._v("/1.5")]),s("div",{staticClass:"text-small text-weaking scale-less-medium"},[t._v("当前/目标(页/人天)")]),s("div",{staticClass:"text-medium"},[s("i",{staticClass:"tw-ico xspeed dt-n1 mr-3"}),t._v("项目效率")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tw-grid-col"},[s("div",{staticClass:"text-huge"},[s("span",{staticClass:"text-highlight"},[t._v("--")]),t._v("/--")]),s("div",{staticClass:"text-small text-weaking scale-less-medium"},[t._v("本月/总数(个)")]),s("div",{staticClass:"text-medium"},[s("i",{staticClass:"tw-ico xbug dt-n1 mr-3"}),t._v("项目缺陷")])])}],i=(s("f548"),s("ce3c"));s("6d57");function c(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,a)}return s}function l(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?c(Object(s),!0).forEach((function(e){Object(i["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):c(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var o={name:"page-project-detail",data(){return{leader:{}}},computed:{planGroupIndexes(){const t=[];return this.project.plans.forEach((e,s)=>{"group"===e.task_type&&t.push(s)}),t},project(){if(this.$api.project.getProjects.data.list[0]){const t=this.$api.project.getProjects.data.list[0];let e=[];for(const s of t.developers)e.push(s.progress<s.expectant_progress?"#fb6c84":"#218fff");return t.developers.forEach(t=>t.total=100),l(l({},t.project),{},{timeNodes:t.timeNodes,plans:t.plans,chartDataMaps:[{name:"百分比",type:"bar",dataset:t.developers,dataKey:"total",barWidth:30,barGap:"-100%",itemStyle:{normal:{color:"#ebeef5"},barBorderRadius:0},tooltip:{show:!1}},{name:"已完成",type:"bar",dataset:t.developers,dataKey:"progress",barWidth:30,itemStyle:{barBorderRadius:0},colors:e}]})}return{plans:[],timeNodes:[],chartData:[],chartDataMaps:[]}}},methods:{format(t){return t+"%"},getProject(){this.$api.project.getProjects.send({id:this.$route.query.id}).then(t=>{t.list&&t.list[0]&&this.$api.user.getUser.send({id:t.list[0].project.project_leader_id}).then(t=>{t.user&&(this.leader=t.user)})})},getOffsetIdx(t){for(var e=0;e<this.planGroupIndexes.length;e++)if(t<this.planGroupIndexes[e])break;return e-1},delProject(){this.$prompt("该删除为物理删除，不可恢复，请输入登录密码继续：","提示",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.{6}/,inputErrorMessage:"请输入密码",inputPlaceholder:"请输入您的登录密码"}).then(t=>{let e=t.value;this.$api.project.del.send({pwd:btoa(e).replace(/=+$/g,""),id:this.$route.query.id}).then(t=>{this.$ui.msg("删除成功"),this.$router.push("/")}).catch(t=>{this.$ui.msg({type:"error",message:"删除失败"})})}).catch(()=>{})}},created(){this.$route.query.id?(this.getProject(),this.$api.dic.degreens.send()):this.$router.push("/")}},p=o,d=s("9ca4"),n=Object(d["a"])(p,a,r,!1,null,null,null);e["default"]=n.exports}}]);